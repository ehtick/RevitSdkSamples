<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Lab2_4_EditFamilyInstance Class</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Labs" /><meta name="file" content="a7ba3ddd-b7d8-9bdf-4c88-563eacb77753" /><meta name="guid" content="a7ba3ddd-b7d8-9bdf-4c88-563eacb77753" /><xml><MSHelp:Attr Name="AssetID" Value="T:Labs.Lab2_4_EditFamilyInstance" /><MSHelp:TOCTitle Title="Lab2_4_EditFamilyInstance Class" /><MSHelp:RLTitle Title="Lab2_4_EditFamilyInstance Class (Labs)" /><MSHelp:Keyword Index="A" Term="T:Labs.Lab2_4_EditFamilyInstance" /><MSHelp:Keyword Index="A" Term="frlrfLabsLab2_4_EditFamilyInstanceClassTopic" /><MSHelp:Keyword Index="K" Term="Lab2_4_EditFamilyInstance class" /><MSHelp:Keyword Index="K" Term="Labs.Lab2_4_EditFamilyInstance class" /><MSHelp:Keyword Index="K" Term="Lab2_4_EditFamilyInstance class, about Lab2_4_EditFamilyInstance class" /><MSHelp:Keyword Index="F" Term="Lab2_4_EditFamilyInstance" /><MSHelp:Keyword Index="F" Term="Labs.Lab2_4_EditFamilyInstance" /><MSHelp:Attr Name="HelpPriority" Value="2" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="labs.dll" /><MSHelp:Attr Name="APIName" Value="Labs.Lab2_4_EditFamilyInstance" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="DevLang" Value="C++" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Demonstrate access to family instance parameters and modification of family instance location. Edit all doors in the current project. Move the doors up 0.2 feet via the Document.Move method and widen them 1 foot by changing the WINDOW_WI ..." /><MSHelp:Attr Name="AssemblyVersion" Value="3.0.0.1" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"></script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit API Introduction Labs</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Lab2_4_EditFamilyInstance Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="3e54607b-6435-fc9c-272a-79d001ff482f.htm">Members</a>  <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a>  
  <span id="headfeedbackarea" class="feedbackhead">
      <a href="javascript:SubmitFeedback('','Revit API Introduction Labs','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">
        
        Send Feedback
      </a>
	</span>
</td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"> </span><div class="summary">
 Demonstrate access to family instance parameters
 and modification of family instance location.

 Edit all doors in the current project.
 Move the doors up 0.2 feet via the Document.Move method
 and widen them 1 foot by changing the WINDOW_WIDTH parameter value.

 <p>
      In this lab, we select all doors in current document,
      move them up by 0.2 feet via the Document.Move method and widen
      them by one foot by changing the WINDOW_WIDTH parameter value.
    </p><p>
      Add a new command named Lab2_4_EditFamilyInstance to the Labs2 module.
      Retrieve all doors in the current document using a filtered collector like
      in the previous lab, either explicitly instantiating it and asking for
      the appropriate category and System.Type, or using one of the LabUtils
      methods such as GetElementsOfType or (most efficiently) GetFamilyInstances.
    </p><p>
      Go through the returned elements and move each door up using
      the Document.Move method. Increasing the door width can be achieved
      by changing the value of the built-in parameter WINDOW_WIDTH. Note
      that this parameter is on the door symbol, i.,e a type parameter.
      What happens if there are many doors in the model?
      In what way does this behaviour depend on the regeneration option?
    </p><p>
      Since this command modifies the database, we need to return a
      Succeeded result code or the changes will be discarded.
    </p><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>C#</div><div class="code"><pre>FilteredElementCollector doors = LabUtils.GetFamilyInstances(
  doc, BuiltInCategory.OST_Doors );

<span class="highlight-comment">// move doors up 0.2 feet:</span>

XYZ v = <span class="highlight-number">0.2</span> * XYZ.BasisZ;

<span class="highlight-keyword">foreach</span>( FamilyInstance door <span class="highlight-keyword">in</span> doors )
{
  doc.Move( door, v );

  <span class="highlight-comment">// widen doors by one foot by changing parameter value:</span>

  Parameter p = door.Symbol.get_Parameter(
    BuiltInParameter.WINDOW_WIDTH );

  <span class="highlight-keyword">if</span>( <span class="highlight-keyword">null</span> != p )
  {
    <span class="highlight-keyword">double</span> width = p.AsDouble();
    width += <span class="highlight-number">1.0</span>;
    p.Set( width );
  }
}
<span class="highlight-keyword">return</span> Result.Succeeded;</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img src="../icons/CopyCode.gif" style="margin-right: 5px;" />Copy</span>VB.NET</div><div class="code"><pre><span class="highlight-keyword">Dim</span> doors <span class="highlight-keyword">As</span> FilteredElementCollector _
    = LabUtils.GetFamilyInstances(doc, BuiltInCategory.OST_Doors)

<span class="highlight-comment">' move doors up 0.2 feet:</span>


<span class="highlight-keyword">Dim</span> v <span class="highlight-keyword">As</span> XYZ = <span class="highlight-number">0.2</span> * XYZ.BasisZ

<span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> door <span class="highlight-keyword">As</span> FamilyInstance <span class="highlight-keyword">In</span> doors
    doc.Move(door, v)

    <span class="highlight-comment">' widen doors by one foot by changing parameter value:</span>


    <span class="highlight-keyword">Dim</span> p <span class="highlight-keyword">As</span> Parameter = door.Symbol.Parameter(BuiltInParameter.WINDOW_WIDTH)

    <span class="highlight-keyword">If</span> p <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">Dim</span> width <span class="highlight-keyword">As</span> <span class="highlight-keyword">Double</span> = p.AsDouble()
        width += <span class="highlight-number">1</span>
        p.<span class="highlight-keyword">Set</span>(width)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">Next</span>

<span class="highlight-keyword">Return</span> Result.Succeeded</pre></div></span><p>
      Before running the command, please ensure that there is at least
      one door in the model.
    </p></div><p />
    <b>Namespace:</b> 
   <a href="715b3539-b2e6-3295-58e6-1481eea1cf44.htm">Labs</a><br />
    <b>Assembly:</b>
   <span sdata="assembly">labs</span> (in labs.dll) Version: 3.0.0.1 (3.0.0.1)<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">Lab2_4_EditFamilyInstance</span> : <span class="nolink">IExternalCommand</span></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic (Declaration)</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">Lab2_4_EditFamilyInstance</span> _
	<span class="keyword">Implements</span> <span class="nolink">IExternalCommand</span></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">Lab2_4_EditFamilyInstance</span> : <span class="nolink">IExternalCommand</span></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>Object</a><br />  <span class="selflink">Labs<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span></span>Lab2_4_EditFamilyInstance</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="3e54607b-6435-fc9c-272a-79d001ff482f.htm">Lab2_4_EditFamilyInstance Members</a></div><div class="seeAlsoStyle"><a href="715b3539-b2e6-3295-58e6-1481eea1cf44.htm">Labs Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"> </span>
 <p /><a href="Copyright (C) 2010 Jeremy Tammik, Autodesk Inc." target="_blank">Copyright (C) 2010 Jeremy Tammik, Autodesk Inc.</a></div></div></body></html>